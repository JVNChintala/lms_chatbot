<!-- File Upload Interface for Canvas Integration -->
<div class="file-upload-widget" style="margin: 15px 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">
    <div class="upload-header" style="font-size: 16px; font-weight: 600; margin-bottom: 15px; text-align: center;">
        üìÅ File Upload & Canvas Integration
    </div>
    
    <!-- Upload Form -->
    <div class="upload-form" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
        <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.txt,.png,.jpg,.jpeg,.mp4,.ppt,.pptx" 
               style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.2); color: white;">
        
        <div style="margin: 10px 0;">
            <select id="uploadType" style="width: 100%; padding: 8px; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.2); color: white;">
                <option value="assignment">Create Assignment</option>
                <option value="module">Add to Module</option>
                <option value="submission">Submit Assignment</option>
            </select>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
            <input type="number" id="courseId" placeholder="Course ID" 
                   style="padding: 8px; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.2); color: white;">
            <input type="text" id="itemName" placeholder="Assignment/Module Name" 
                   style="padding: 8px; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.2); color: white;">
        </div>
        
        <button onclick="uploadFile()" 
                style="width: 100%; padding: 10px; background: rgba(255,255,255,0.3); color: white; border: 1px solid rgba(255,255,255,0.5); border-radius: 4px; cursor: pointer; font-weight: 600;">
            üì§ Upload to Canvas
        </button>
    </div>
    
    <!-- Upload Status -->
    <div id="uploadStatus" style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 6px; font-size: 12px; display: none;">
        <div id="statusText">Ready to upload...</div>
        <div id="progressBar" style="width: 100%; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px; margin-top: 5px;">
            <div id="progress" style="width: 0%; height: 100%; background: #4ade80; border-radius: 2px; transition: width 0.3s;"></div>
        </div>
    </div>
    
    <!-- Supported File Types -->
    <div style="font-size: 11px; opacity: 0.8; text-align: center; margin-top: 10px;">
        üìÑ Supported: PDF, DOC, TXT, Images, Videos, Presentations (Max 100MB)
    </div>
</div>

<script>
async function uploadFile() {
    const fileInput = document.getElementById('fileInput');
    const uploadType = document.getElementById('uploadType').value;
    const courseId = document.getElementById('courseId').value;
    const itemName = document.getElementById('itemName').value;
    const statusDiv = document.getElementById('uploadStatus');
    const statusText = document.getElementById('statusText');
    const progressBar = document.getElementById('progress');
    
    if (!fileInput.files[0]) {
        alert('Please select a file');
        return;
    }
    
    if (!courseId || !itemName) {
        alert('Please fill in Course ID and Item Name');
        return;
    }
    
    const file = fileInput.files[0];
    statusDiv.style.display = 'block';
    statusText.textContent = 'Uploading file...';
    progressBar.style.width = '30%';
    
    try {
        // Create FormData for file upload
        const formData = new FormData();
        formData.append('file', file);
        formData.append('upload_type', uploadType);
        formData.append('course_id', courseId);
        formData.append('item_name', itemName);
        
        // Upload to backend
        const response = await fetch('/upload-file', {
            method: 'POST',
            body: formData
        });
        
        progressBar.style.width = '70%';
        
        const result = await response.json();
        
        if (result.success) {
            progressBar.style.width = '100%';
            statusText.textContent = `‚úÖ ${result.message}`;
            statusText.style.color = '#4ade80';
            
            // Clear form
            fileInput.value = '';
            document.getElementById('itemName').value = '';
        } else {
            statusText.textContent = `‚ùå Error: ${result.error}`;
            statusText.style.color = '#f87171';
        }
        
    } catch (error) {
        statusText.textContent = `‚ùå Upload failed: ${error.message}`;
        statusText.style.color = '#f87171';
    }
}
</script>